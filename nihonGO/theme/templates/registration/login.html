{% extends 'components/wrapper.html' %}

{% block content %}
    <div class="py-2">
        <div class="py-16">
            <h1 class="text-center text-title text-black font-outfit font-bold relative">
                おかえり!
            </h1>            
        
    <!-- Error messages -->
    {% if form.errors %}
        <div class="text-crimson text-center">
            {% for field in form %}
                {% for error in field.errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
                <p>{{ error }}</p>
            {% endfor %}
        </div>
    {% endif %}
    
    <form class="space-y-4 md:space-y-6 font-outfit" action="{% url 'login' %}" method="POST">
                {% csrf_token %}
        
                <div class="flex flex-col space-y-4 justify-center mx-96 3xl:mx-[600px]">
                    {{ form.username }}
                    {{ form.password }}
                </div>
                <input type="hidden" name="next" value="{% url 'my-profile' %}">
                <div class="flex flex-col justify-center items-center">
                    <label class="mb-6"><input type="checkbox" name="remember_me" id="remember_me" class="border border-2 border-black rounded-md mr-2">Remember Me</label>
                    <button type='submit' class="bg-orange text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-crimson transition duration-300">Login</button><br>
                    <a href="{% url 'password_reset' %}" class="text-sm font-medium text-black text-opacity-75 hover:underline mb-3">Forgot password?</a>
                </div>
            </form>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            let rememberMeCheckbox = document.getElementById("remember_me");
            let usernameInput = document.getElementById("username"); // Matches corrected username field ID
            let passwordInput = document.getElementById("password"); // Matches corrected password field ID
    
            // Check if username and password are stored
            if (localStorage.getItem("rememberMe") === "true") {
                usernameInput.value = localStorage.getItem("username");
                passwordInput.value = localStorage.getItem("password");
                rememberMeCheckbox.checked = true;
            }
    
            // Save username and password when "Remember Me" is checked
            document.querySelector("form").addEventListener("submit", () => {
                if (rememberMeCheckbox.checked) {
                    localStorage.setItem("rememberMe", "true");
                    localStorage.setItem("username", usernameInput.value);
                    localStorage.setItem("password", passwordInput.value);
                } else {
                    localStorage.setItem("rememberMe", "false");
                    localStorage.removeItem("username");
                    localStorage.removeItem("password");
                }
            });
        });
    </script>
{% endblock %}





